

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4. Integration &#8212; PHYS3820 Computational Physics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mycss.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-NZTDTEW863"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-NZTDTEW863');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter_4/Integration';</script>
    <link rel="canonical" href="https://saturnaxis.github.io/CompPhysics/Chapter_4/Integration.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Differentiation and Searching" href="../Chapter_5/Differentiation.html" />
    <link rel="prev" title="3. Data Fitting and Interpolation" href="../Chapter_3/Data_Fitting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../home.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Comp_Physics_diagram.png" class="logo__image only-light" alt="PHYS3820 Computational Physics - Home"/>
    <script>document.write(`<img src="../_static/Comp_Physics_diagram.png" class="logo__image only-dark" alt="PHYS3820 Computational Physics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../home.html">
                    PHYS3820 Computational Physics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Chapter_1/Gentle_Introduction.html">1. Useful Introduction to Python, GitHub, and LaTex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter_2/Python_Basics.html">2. Python Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter_3/Data_Fitting.html">3. Data Fitting and Interpolation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter_5/Differentiation.html">5. Differentiation and Searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter_6/ODEs.html">6. Ordinary Differential Equations (ODEs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Chapter_7/Eigenvalues.html">7. Eigenvalue Problems</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/saturnaxis/CompPhysics/main?urlpath=tree/Chapter_4/Integration.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/saturnaxis/CompPhysics/blob/main/Chapter_4/Integration.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://github.com/saturnaxis/CompPhysics" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapter_4/Integration.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Integration</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quadrature-as-box-counting">4.1. Quadrature as box counting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trapezoidal-rule">4.2. Trapezoidal Rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpson-s-rule">4.3. Simpson’s Rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-quadrature">4.4. Gaussian Quadrature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-error">4.5. Integration Error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-by-stone-throwing">4.6. Integration by Stone Throwing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-by-mean-value">4.7. Integrating by Mean Value</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">4.8. Problems</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="integration">
<h1><span class="section-number">4. </span>Integration<a class="headerlink" href="#integration" title="Permalink to this heading">#</a></h1>
<p>Numerical integration is a fundamental skill in computational physics because it allows one to evaluate increasingly complex integrals with a high accuracy <em>in seconds to minutes</em>.  If you’ve ever tried to evaluate particularly nasty integrals, you notice that those can take pages of algebra, transformations, and still only get to an approximate form.  It is especially frustrating when one makes algebraic mistakes and you have to do it over.  In this chapter, we will review basic integration methods that you’ve learned in Calculus and develop those methods in <strong>python</strong>.  After reading this chapter, check out some python packages that others have developed to make the process of numerical integration easier to access using <a class="reference external" href="https://github.com/nschloe/quadpy">quadpy</a>.</p>
<div align="center">
<iframe width="560" height="315"
src="https://www.youtube.com/embed/rfG8ce4nNh0"
frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe>
</div>
<section id="quadrature-as-box-counting">
<h2><span class="section-number">4.1. </span>Quadrature as box counting<a class="headerlink" href="#quadrature-as-box-counting" title="Permalink to this heading">#</a></h2>
<p>The integration of a function usually requires some trickery, where you have to know which variable transformation to apply and when to apply it.  Due to the precise repetitiveness of a computer, an integral can be evaluated in a straightforward manner.  You may recall that you first performed integration by counting the number of boxes (or quadrilaterals) that you could place beneath a curve.  As a result, numerical integration is also called <em>quadrature</em> even when it comes to more complex methods.</p>
<p>We’ll start our review with the Riemann definition of an integral, which is given as the limit of the sum over boxes of width <em>h</em>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-3f3e1606-8cfd-45a4-aa93-048163c470dc">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-3f3e1606-8cfd-45a4-aa93-048163c470dc" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_a^b f(x)dx = \lim_{h\rightarrow 0} \left[h \sum_{i=1}^{(b-a)/h} f(x_i) \right].
\end{align}\]</div>
<figure class="align-default" id="basic-integral-fig">
<a class="reference internal image-reference" href="../_images/integral_example.png"><img alt="basic integral" src="../_images/integral_example.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Illustration of a basic integral with 4 subdivisions. Figure adapted from <a class="reference external" href="https://www.google.com/books/edition/_/RBg-vgAACAAJ?hl">Landau, Paez, &amp; Bordeianu (2007)</a>.</span><a class="headerlink" href="#basic-integral-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The numerical integral of a function <span class="math notranslate nohighlight">\(f(x)\)</span> is approximated as the equivalent of a <em>finite</em> sum of quadrilaterals with a height defined as <span class="math notranslate nohighlight">\(f(x)\)</span> and width <span class="math notranslate nohighlight">\(w_i\)</span> to get:</p>
<div class="math notranslate nohighlight" id="equation-integral-form">
<span class="eqno">(4.2)<a class="headerlink" href="#equation-integral-form" title="Permalink to this equation">#</a></span>\[\int_a^b f(x)dx \simeq \sum_{i=1}^{N} f(x_i)w_i.\]</div>
<p>You will notice that this is similar to the Riemann definition, but the limit for an infinitesimal box size is removed and the upper limit for the summation is redefined as the number <span class="math notranslate nohighlight">\(N\)</span> of quadrilaterals.  Each of the function values <span class="math notranslate nohighlight">\(f(x_i)\)</span> are weighted by <span class="math notranslate nohighlight">\(w_i\)</span>.  As we make <span class="math notranslate nohighlight">\(N\)</span> larger, the approximation will become more exact but this comes at a cost.</p>
<ol class="arabic simple">
<li><p>A computer holds numbers to a finite precision and some values in <span class="math notranslate nohighlight">\(N\)</span> won’t increase the accuracy of the integration.</p></li>
<li><p>We’ll find that more calculations take more wall time (i.e., our time to do work) and we may have to wait an extremely long time for the integration to finish.</p></li>
</ol>
<p>Eventually we have to truncate the sum to get the “best” approximation, and we have to remember that we are making a tradeoff.</p>
<p>Something that you should <strong>never</strong> do is to attempt a numerical integration when the integrand contains a singularity <strong>without</strong> first removing the singularity by hand.  Some ways to remove the singularity is to assign intervals so that the singularity lies at an endpoints or by a change of variable:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c049bcff-b07e-4bcf-9dd5-8e92549e10fc">
<span class="eqno">(4.3)<a class="headerlink" href="#equation-c049bcff-b07e-4bcf-9dd5-8e92549e10fc" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_{-1}^1 |x|f(x)dx &amp;= \int_{-1}^0 f(-x)dx + \int_0^1 f(x)dx, \\
\int_0^1 x^{1/3}dx &amp;= \int_0^1 3y^3,\;\; (y=x^{1/3}).
\end{align}\]</div>
<p>On the other hand, you might have an integrand that changes very quickly/slowly and scaling the boxes according to the variation may be necessary.  There are several approaches to scale the boxes for your integration and we’ll explore two of them in the following sections:</p>
<ul class="simple">
<li><p>Trapezoidal Rule, and</p></li>
<li><p>Simpson’s Rule</p></li>
</ul>
<p>that you may recall from Calculus.</p>
</section>
<section id="trapezoidal-rule">
<h2><span class="section-number">4.2. </span>Trapezoidal Rule<a class="headerlink" href="#trapezoidal-rule" title="Permalink to this heading">#</a></h2>
<p>The trapezoid integration rule uses <span class="math notranslate nohighlight">\(f(x)\)</span> at <em>evenly</em> spaced values of <span class="math notranslate nohighlight">\(x\)</span>, with <span class="math notranslate nohighlight">\(N\)</span> points.  The first point <span class="math notranslate nohighlight">\(x_1\)</span> locates the left-side boundary and <span class="math notranslate nohighlight">\(x_N\)</span> locates the right-side boundary to form the integration region [<span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_N\)</span>] or [a,b].  The brackets indicate that the endpoints are included and then we can divide up the integration region into <span class="math notranslate nohighlight">\(N-1\)</span> intervals or chunks.  The interval width is defined as <span class="math notranslate nohighlight">\(h\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9efdf93f-e4cf-49b1-99fa-b50634bef361">
<span class="eqno">(4.4)<a class="headerlink" href="#equation-9efdf93f-e4cf-49b1-99fa-b50634bef361" title="Permalink to this equation">#</a></span>\[\begin{align}
h = \frac{b-a}{N-1}
\end{align}\]</div>
<p>and the location of each point along the interval is defined linearly because each interval has a fixed width.  Thus, we write the iterative formula for <span class="math notranslate nohighlight">\(x_i\)</span> as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-344af63c-de16-4c04-b07d-90a1cc593236">
<span class="eqno">(4.5)<a class="headerlink" href="#equation-344af63c-de16-4c04-b07d-90a1cc593236" title="Permalink to this equation">#</a></span>\[\begin{align}
x_i = a + (i-1)h,
\end{align}\]</div>
<p>where we start our counting at <span class="math notranslate nohighlight">\(i=1\)</span>.  <strong>Does this equation return the left boundary when applying <span class="math notranslate nohighlight">\(i=1\)</span>?  What about the right boundary when <span class="math notranslate nohighlight">\(i=N\)</span>?</strong></p>
<figure class="align-default" id="trap-rule-fig">
<a class="reference internal image-reference" href="../_images/Trap_rule.png"><img alt="Trapezoidal rule" src="../_images/Trap_rule.png" style="width: 450px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.2 </span><span class="caption-text">Straight line sections are used to approximate the area under the curve via the trapezoidal rule. Figure adapted from <a class="reference external" href="https://www.google.com/books/edition/_/RBg-vgAACAAJ?hl">Landau, Paez, &amp; Bordeianu (2007)</a>.</span><a class="headerlink" href="#trap-rule-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div align="center">
<iframe width="560" height="315"
src="https://www.youtube.com/embed/1p0NHR5w0Lc"
frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe>
</div>
<p>The trapezoid rule takes each integration interval and constructs a trapezoid of width <span class="math notranslate nohighlight">\(h\)</span>.  Recall the area of a trapezoid is the average height of the two (long) parallel sides multiplied by the width.  To define the height for each side, we evaluate the function <span class="math notranslate nohighlight">\(f(x)\)</span> at boundary points for the given interval, <span class="math notranslate nohighlight">\(f(x_i)\)</span> and <span class="math notranslate nohighlight">\(f(x_{i+1})\)</span>.  The area of each such trapezoid is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-0463a8ba-770c-4b79-9bee-c2042d4b9e15">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-0463a8ba-770c-4b79-9bee-c2042d4b9e15" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_{x_i}^{x_{i+1}} f(x)dx \simeq \frac{f(x_i)+f(x_{i+1})}{2}h.
\end{align}\]</div>
<p>In terms of our standard integration formula (Eq. <a class="reference internal" href="#equation-integral-form">(4.2)</a>), the weights <span class="math notranslate nohighlight">\(w_i = 1/2\)</span>.  To apply the trapezoidal rule to the entire integration region [a,b], we simply add the contributions from each interval:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b1a1316f-dfec-4970-9942-3c7eb96e1838">
<span class="eqno">(4.7)<a class="headerlink" href="#equation-b1a1316f-dfec-4970-9942-3c7eb96e1838" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_a^b f(x)dx \simeq \left[\frac{h}{2}a + \frac{h}{2}f(x_2)\right] + \left[\frac{h}{2}f(x_2) + \frac{h}{2}f(x_3)\right] + \cdots + \left[\frac{h}{2}f(x_{N-1}) + \frac{h}{2}b\right].
\end{align}\]</div>
<p>You will notice that some interval points are counted twice as the end of one interval and as the beginning of the next, whereas the endpoints are just counted once.  We could now define all the weights for our standard function as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e1267585-48e5-438b-ba58-a0b3e6941852">
<span class="eqno">(4.8)<a class="headerlink" href="#equation-e1267585-48e5-438b-ba58-a0b3e6941852" title="Permalink to this equation">#</a></span>\[\begin{align}
w_i = \left[\frac{h}{2},h,\cdots,h,\frac{h}{2} \right].
\end{align}\]</div>
<p>These weights combine the double counted intervals (<span class="math notranslate nohighlight">\(h/2 + h/2 = h\)</span>).  Now let’s turn this mathematical rule into code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#TrapMethods;  Trapezoid integration of a function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#Define the boundary values [a,b] and the number of intervals N</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mi">4</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1">#f(x) is a function of x</span>
    <span class="c1">#x is the independent variable</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; x, f(x) = </span><span class="si">%1.1f</span><span class="s2">, </span><span class="si">%1.1f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> 

<span class="k">def</span> <span class="nf">func_weight</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">h</span><span class="p">):</span> 
    <span class="c1">#weights for the trapezoid rule</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">i</span><span class="o">==</span> <span class="n">N</span><span class="p">:</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="mf">2.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">h</span>
    <span class="k">return</span> <span class="n">weight</span>

<span class="c1">#width of each interval</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">tot_sum</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
   <span class="n">x_i</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">h</span>
   <span class="n">tot_sum</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">x_i</span><span class="p">)</span><span class="o">*</span><span class="n">func_weight</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">h</span><span class="p">)</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Total sum = &#39;</span><span class="p">,</span> <span class="n">tot_sum</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Analytical sum = &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">3.</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> x, f(x) = 0.0, 0.0
 x, f(x) = 1.0, 1.0
 x, f(x) = 2.0, 4.0
 x, f(x) = 3.0, 9.0
 Total sum =  9.5
 Analytical sum =  9.0
</pre></div>
</div>
</div>
</div>
<p>In the code, we can see each of the elements of the trapezoid rule. Most importantly, you should notice that the standard integration formula includes a summation <span class="math notranslate nohighlight">\(\Sigma\)</span> and in code that translates into a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.  Everything else maps directly to what you might expect.  The analytical sum is also calculated because the function <span class="math notranslate nohighlight">\(f(x) = x^2\)</span> and we know its integral is evaluated as <span class="math notranslate nohighlight">\(x^3/3\)</span> at the interval boundaries.  <strong>Why are the values not equal?</strong>  <strong>What happens if we increase the value of <span class="math notranslate nohighlight">\(N\)</span>?</strong></p>
</section>
<section id="simpson-s-rule">
<h2><span class="section-number">4.3. </span>Simpson’s Rule<a class="headerlink" href="#simpson-s-rule" title="Permalink to this heading">#</a></h2>
<p>Simpson’s integration rule approximates the integrand <span class="math notranslate nohighlight">\(f(x)\)</span> by a parabola instead of a trapezoid:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d15e26c3-a84a-4b69-a47c-b0073d40f1a0">
<span class="eqno">(4.9)<a class="headerlink" href="#equation-d15e26c3-a84a-4b69-a47c-b0073d40f1a0" title="Permalink to this equation">#</a></span>\[\begin{align}
f(x) \simeq \alpha x^2 + \beta x + \gamma,
\end{align}\]</div>
<p>with equally spaced intervals, where weights are <span class="math notranslate nohighlight">\(\alpha,\ \beta,\)</span> and  <span class="math notranslate nohighlight">\(\gamma\)</span>.  We can calculate the area under the parabola for each interval as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6c026c73-3ec8-4cfc-a4b2-c347e4393330">
<span class="eqno">(4.10)<a class="headerlink" href="#equation-6c026c73-3ec8-4cfc-a4b2-c347e4393330" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_{x_i}^{x_i+h} (\alpha x^2 + \beta x + \gamma)dx = \frac{\alpha x^3}{3} + \frac{\beta x^2}{2} + \gamma x \biggr\rvert_{x_i}^{x_i+h}.
\end{align}\]</div>
<figure class="align-default" id="simp-rule-fig">
<a class="reference internal image-reference" href="../_images/Simpson_rule.png"><img alt="Simpson rule" src="../_images/Simpson_rule.png" style="width: 450px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.3 </span><span class="caption-text">Two parabolas are used to approximate the area under the curve via Simpson’s rule. Figure adapted from <a class="reference external" href="https://www.google.com/books/edition/_/RBg-vgAACAAJ?hl">Landau, Paez, &amp; Bordeianu (2007)</a>.</span><a class="headerlink" href="#simp-rule-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To determine the weights, let’s use the interval [-1,1] and the integral becomes:</p>
<div class="math notranslate nohighlight" id="equation-simpson-int">
<span class="eqno">(4.11)<a class="headerlink" href="#equation-simpson-int" title="Permalink to this equation">#</a></span>\[\int_{-1}^1 (\alpha x^2 + \beta x + \gamma)dx = \frac{2\alpha}{3} + 2\gamma. \]</div>
<p>But we know that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
f(0) &amp;= \gamma, \\
f(1) &amp;= \alpha + \beta + \gamma, \\
f(-1) &amp;= \alpha - \beta + \gamma. 
\end{align*}\]</div>
<p>The weight <span class="math notranslate nohighlight">\(\alpha\)</span> can be determined by <span class="math notranslate nohighlight">\(f(1) + f(-1)\)</span> because the <span class="math notranslate nohighlight">\(\beta\)</span> cancels and <span class="math notranslate nohighlight">\(\gamma\)</span> is known directly.  The weight <span class="math notranslate nohighlight">\(\beta\)</span> can be determined in a similar manner but through the difference to get the <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span> to cancel.  Thus, we find:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ab8dc509-c539-417b-9798-41ae80daaee6">
<span class="eqno">(4.12)<a class="headerlink" href="#equation-ab8dc509-c539-417b-9798-41ae80daaee6" title="Permalink to this equation">#</a></span>\[\begin{align}
\alpha &amp;= \frac{f(1) + f(-1)}{2} - \gamma, \\
\beta &amp;= \frac{f(1) - f(-1)}{2}, \\
\gamma &amp;= f(0).
\end{align}\]</div>
<p>Now, we can substitute the values for the weights into Eq. <a class="reference internal" href="#equation-simpson-int">(4.11)</a>, but in terms of function evaluations over three points:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c797926e-cd28-456b-845d-9e784ae92c5d">
<span class="eqno">(4.13)<a class="headerlink" href="#equation-c797926e-cd28-456b-845d-9e784ae92c5d" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_{-1}^1 (\alpha x^2 + \beta x + \gamma)dx = \frac{f(1)}{3}  + \frac{4f(0)}{3} + \frac{f(-1)}{3}.
\end{align}\]</div>
<p>Since three points were required, we generalize this solution to include the two endpoints of a given interval and the midpoint (which lies at <span class="math notranslate nohighlight">\(x_i + h/2\)</span>).  This can be written ast the following integral:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6dfca6cf-a87e-46e0-9b07-3ac1476d04f3">
<span class="eqno">(4.14)<a class="headerlink" href="#equation-6dfca6cf-a87e-46e0-9b07-3ac1476d04f3" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_{x_i-h}^{x_i + h} f(x)dx &amp;= \int_{x_i}^{x_i+h/2} f(x) dx + \int_{x_i+h/2}^{x_i+h} f(x) dx, \\
&amp;= \frac{\alpha x^3}{3} + \frac{\beta x^2}{2} + \gamma x \biggr\rvert_{x_i}^{x_i+h/2} + \frac{\alpha x^3}{3} + \frac{\beta x^2}{2} + \gamma x \biggr\rvert_{x_i+h/2}^{x_i+h},
\end{align}\]</div>
<p>or</p>
<div class="amsmath math notranslate nohighlight" id="equation-022434a1-618d-425d-84bf-5a4ed6a1e8d8">
<span class="eqno">(4.15)<a class="headerlink" href="#equation-022434a1-618d-425d-84bf-5a4ed6a1e8d8" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_{x_i-h}^{x_i + h} f(x)dx \simeq \frac{h}{6}f(x_{i}) + \frac{4h}{6}f(x_{i}+h/2) + \frac{h}{6}f(x_{i+1}),
\end{align}\]</div>
<p>where the first point <span class="math notranslate nohighlight">\(x_{i}\)</span> takes the place of <span class="math notranslate nohighlight">\(-1\)</span> and the next point <span class="math notranslate nohighlight">\(x_{i+1}\)</span> takes the place of the <span class="math notranslate nohighlight">\(+1\)</span>.</p>
<p>Simpson’s rule requires the integration to be over <em>pairs of intervals</em> because it uses 3 points.  This implies that the <em>total number of points <span class="math notranslate nohighlight">\(N\)</span> be odd</em> and the <em>total number of intervals <span class="math notranslate nohighlight">\(N-1\)</span> is even</em>.  To apply Simpson’s rule over the entire integration region, we just add up all of the intervals.</p>
<p>Here, the points (<span class="math notranslate nohighlight">\(f(x_1)\)</span> and <span class="math notranslate nohighlight">\(f(x_N)\)</span>) are counted once, the points in between <span class="math notranslate nohighlight">\((f(x_2),\ldots,f(x_{N-1})\)</span> are counted twice, and the midpoints <span class="math notranslate nohighlight">\(f((x_i + x_{i+1})/2)\)</span> are counted once to get:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5780b110-8a4a-4382-bb34-19c71d858c1c">
<span class="eqno">(4.16)<a class="headerlink" href="#equation-5780b110-8a4a-4382-bb34-19c71d858c1c" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_a^b f(x)dx \simeq \left[ \frac{h}{6}f(x_{1}) + \frac{4h}{6}f\left(\frac{x_1+x_2}{2}\right) + \frac{h}{6}f(x_{2})\right] + \left[ \frac{h}{6}f(x_{2}) + \frac{4h}{6}f\left(\frac{x_2+x_3}{2}\right) + \frac{h}{6}f(x_{3})\right]  + \cdots + \left[ \frac{h}{6}f(x_{N-1}) +\frac{4h}{6}f\left(\frac{x_{N-1}+x_N}{2}\right)+ \frac{h}{6}f(x_{N})\right]
\end{align}\]</div>
<p>or</p>
<div class="amsmath math notranslate nohighlight" id="equation-fd7af097-336f-475b-98b8-5e7da8ef344b">
<span class="eqno">(4.17)<a class="headerlink" href="#equation-fd7af097-336f-475b-98b8-5e7da8ef344b" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_a^b f(x)dx \simeq \frac{1}{2}\sum_{i=1}^{N-1} \frac{h}{3}\left[ f(x_{i}) + 4f\left(\frac{x_i+x_{i+1}}{2}\right) + f(x_{i+1})\right].
\end{align}\]</div>
<div align="center">
<iframe width="560" height="315"
src="https://www.youtube.com/embed/uc4xJsi99bk"
frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SimpMethods;  Simpson&#39;s integration of a function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#Define the boundary values [a,b] and the number of intervals N</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mi">4</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1">#f(x) is a function of x</span>
    <span class="c1">#x is the independent variable</span>
    <span class="c1">#print(&quot; x, f(x) = %1.1f, %1.1f&quot; % (x,x*x))</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>

<span class="c1">#width of each interval</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">tot_sum</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
   <span class="n">x_left</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">h</span>
   <span class="n">x_right</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">h</span>
   <span class="n">x_mid</span> <span class="o">=</span> <span class="n">x_left</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span>
   <span class="n">tot_sum</span> <span class="o">+=</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mf">6.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">x_left</span><span class="p">)</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">x_mid</span><span class="p">)</span><span class="o">+</span><span class="n">func</span><span class="p">(</span><span class="n">x_right</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Total sum = &#39;</span><span class="p">,</span> <span class="n">tot_sum</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Analytical sum = &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">3.</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Total sum =  9.0
 Analytical sum =  9.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="gaussian-quadrature">
<h2><span class="section-number">4.4. </span>Gaussian Quadrature<a class="headerlink" href="#gaussian-quadrature" title="Permalink to this heading">#</a></h2>
<p>The Trapezoid Rule and Simpson’s Rule use equidistant points and weights, which is adequate for some cases.  But, we can generalize those methods by relaxing the requirement for equidistant points.  Recall that our standard integration formula is composed of a set of chosen points <span class="math notranslate nohighlight">\(x_i\)</span> and corresponding weights <span class="math notranslate nohighlight">\(w_i\)</span>.  There is <strong>not</strong> a law stating that the <span class="math notranslate nohighlight">\(x_i\)</span> points should be chosen a particular way.  In Gaussian quadrature methods,</p>
<ul class="simple">
<li><p>we choose a series of points from a complex function that can be represented as a series of polynomials (e.g., Legendre, Laguerre, etc.),</p></li>
<li><p>the benefit is that these functions can be solved on the interval [-1,1] exactly,</p></li>
<li><p>perform a variable transformation to <strong>map</strong> the known solution onto the unknown solution [-1,1]–&gt;[a,b],</p></li>
<li><p>the error is reduced because the approximation is more exact.</p></li>
</ul>
<p>Let’s start with an example.  We want to select points and weights using only 2 points within the integration region.  From this goal, we write:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b3e080d5-9305-4fc2-8f54-acf0375ba327">
<span class="eqno">(4.18)<a class="headerlink" href="#equation-b3e080d5-9305-4fc2-8f54-acf0375ba327" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_{-1}^1 f(x)dx = w_1f(x_1) + w_2f(x_2),
\end{align}\]</div>
<p>where there will be some number of polynomials of degree <span class="math notranslate nohighlight">\((2n+1)\)</span> and <span class="math notranslate nohighlight">\(n=1\)</span>.  We set up equations for all polynomials from degree <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\((2n + 1)\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-8b511ca5-8033-4a50-ad5c-0faeda46cc0c">
<span class="eqno">(4.19)<a class="headerlink" href="#equation-8b511ca5-8033-4a50-ad5c-0faeda46cc0c" title="Permalink to this equation">#</a></span>\[\begin{align}
\text{degree 0:} &amp;\quad f(x) = 1;&amp;  w_1 + w_2 = \int_{-1}^{1} 1dx = 2, \\
\text{degree 1:} &amp;\quad f(x) = x;&amp;  w_1x_1 + w_2x_2 = \int_{-1}^{1} xdx = 0, \\
\text{degree 2:} &amp;\quad f(x) = x^2;&amp; w_1x_1^2 + w_2x_2^2 = \int_{-1}^{1} x^2dx = 2/3, \\
\text{degree 3:} &amp;\quad f(x) = x^3;&amp; w_1x_3^2 + w_2x_3^2 = \int_{-1}^{1} x^3dx = 0.
\end{align}\]</div>
<p>Now we have 4 equations and 4 unknowns.  Through some algebra, we can find that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w_1 = w_2 = 1\)</span> (not that surprising from degree 0)</p></li>
<li><p><span class="math notranslate nohighlight">\(x_1 = -1/\sqrt{3}\)</span> (from degree 2)</p></li>
<li><p><span class="math notranslate nohighlight">\(x_2 = 1/\sqrt{3}\)</span> (from degree 2; other root)</p></li>
</ul>
<p>This is the beginning of a known procedure using <a class="reference external" href="https://mathworld.wolfram.com/Legendre-GaussQuadrature.html">Legendre polynomials</a>. Now we have to apply a mapping.  The easiest map is from [-1,1]–&gt;[a,b] uniformly, which uses the midpoint = <span class="math notranslate nohighlight">\((a+b)/2\)</span>.  Thus, we can get the mapped points <span class="math notranslate nohighlight">\(x_i^\prime\)</span>, <span class="math notranslate nohighlight">\(w_i^\prime\)</span> through a linear transformation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-0eb336eb-a929-43b0-894e-b950d8dc27c6">
<span class="eqno">(4.20)<a class="headerlink" href="#equation-0eb336eb-a929-43b0-894e-b950d8dc27c6" title="Permalink to this equation">#</a></span>\[\begin{align}
x_i^\prime &amp;= \frac{b+a}{2} + \frac{b-a}{2}x_i, \\
w_i^\prime &amp;= \frac{b-a}{2}w_i.
\end{align}\]</div>
<p>Other mappings can be found in the textbook: <a class="reference external" href="https://www.google.com/books/edition/_/RBg-vgAACAAJ?hl"><strong>Computational Physics: Problem Solving with Computers</strong></a>.</p>
<div align="center">
<iframe width="560" height="315"
src="https://www.youtube.com/embed/w2xjlPwYock"
frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe>
</div>
<p>Let’s turn this into some code and see how well it does.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#IntegGauss.py: Gaussian quadrature up to degree 4 points and weights</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#Define the boundary values [a,b] and the degree N</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1">#function to be integrated</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>

<span class="k">def</span> <span class="nf">gauss</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="c1">#given an interval [a,b] this function will return the scaled points x and weights w</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">15.</span><span class="p">)</span><span class="o">/</span><span class="mf">5.</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.</span><span class="o">/</span><span class="mf">9.</span>
        <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="mf">5.</span><span class="o">/</span><span class="mf">9.</span>
    <span class="k">elif</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">525.</span><span class="o">-</span><span class="mf">70.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">30.</span><span class="p">))</span><span class="o">/</span><span class="mf">35.</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">w</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">18.</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">30.</span><span class="p">))</span><span class="o">/</span><span class="mf">36.</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">525.</span><span class="o">+</span><span class="mf">70.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">30.</span><span class="p">))</span><span class="o">/</span><span class="mf">35.</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">18.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">30.</span><span class="p">))</span><span class="o">/</span><span class="mf">36.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
    <span class="c1">#scale to [a,b]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">w</span>


<span class="n">x_scaled</span><span class="p">,</span> <span class="n">w_scaled</span> <span class="o">=</span> <span class="n">gauss</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="c1">#get points and weights</span>
<span class="n">tot_sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="n">tot_sum</span> <span class="o">+=</span> <span class="n">w_scaled</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">x_scaled</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Total sum = &#39;</span><span class="p">,</span> <span class="n">tot_sum</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Analytical sum = &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mf">3.</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.          0.77459667 -0.77459667] [0.88888889 0.55555556 0.55555556]
 Total sum =  9.0
 Analytical sum =  9.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="integration-error">
<h2><span class="section-number">4.5. </span>Integration Error<a class="headerlink" href="#integration-error" title="Permalink to this heading">#</a></h2>
<p>If you value your own time, then you should choose an integration rule that gives an accurate answer using the least number of integration points.  Simply, fewer integration steps implies that less work needs to be done by the computer and you obtain your result faster.  Additionally, you want an accurate answer and you must realize that we are obtaining estimates of the true answer.  Computers are able to store a finite set of numbers and this results in <em>errors</em>.  We obtain a crude estimate of the <em>approximation</em> or <em>algorithmic error <span class="math notranslate nohighlight">\(\varepsilon\)</span></em> and the <em>relative error <span class="math notranslate nohighlight">\(\epsilon\)</span></em> by expanding <span class="math notranslate nohighlight">\(f(x)\)</span> in a Taylor series around the midpoint of the integration interval.  The error is multiplied by the number of intervals for the entire integration region [a,b].  This is straightforward for the <a class="reference external" href="https://en.wikipedia.org/wiki/Trapezoidal_rule">Trapezoid</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Simpson%27s_rule">Simpson</a> rules because use equidistant intervals.  This process yields:</p>
<div class="amsmath math notranslate nohighlight" id="equation-351fa0b2-67f4-4196-949a-b66e9152d828">
<span class="eqno">(4.21)<a class="headerlink" href="#equation-351fa0b2-67f4-4196-949a-b66e9152d828" title="Permalink to this equation">#</a></span>\[\begin{align}
\varepsilon_{\rm Trap} &amp;= O\left(\frac{[b-a]^3}{12N^2}\right)f^{\prime\prime},\qquad \text{(Trapezoidal Rule)} \\
\varepsilon_{\rm Simp} &amp;\sim O\left(\frac{[b-a]^5}{N^4}\right)f^{\prime\prime\prime\prime}. \qquad \text{(Simpsons Rule)}
\end{align}\]</div>
<p>for the approximation errors and the relative error is simply:</p>
<div class="amsmath math notranslate nohighlight" id="equation-9c4881de-9071-4356-8be8-1f62f5f2dd6c">
<span class="eqno">(4.22)<a class="headerlink" href="#equation-9c4881de-9071-4356-8be8-1f62f5f2dd6c" title="Permalink to this equation">#</a></span>\[\begin{align}
\epsilon_{\rm Trap} &amp;= \varepsilon_{\rm Trap}/f^\prime, \\
\epsilon_{\rm Simp} &amp;= \varepsilon_{\rm Simp}/f^\prime.
\end{align}\]</div>
<p>A more sophisticated integration rule leads to an error that decreases rapidly (due to the higher power of <span class="math notranslate nohighlight">\(N\)</span>) and is proportional to higher derivatives of <span class="math notranslate nohighlight">\(f\)</span>.  In most cases, we should expect Simpson’s rule to converge more rapidly than the Trapezoid rule.</p>
<p>Another source of error is the <em>round-off</em> error, which we assume is random and can thus take the form <span class="math notranslate nohighlight">\(\epsilon_{\rm ro} \simeq \sqrt{N}\epsilon_m\)</span>.  The <span class="math notranslate nohighlight">\(\epsilon_m\)</span> represents machine precision, which is <span class="math notranslate nohighlight">\(\epsilon \sim 10^{-15}\)</span> for double precision (the standard for science).  You can find more on data types <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/02.01-understanding-data-types.html">here</a>.</p>
<p>Assuming double precision, we want to determine an <span class="math notranslate nohighlight">\(N\)</span> that minimizes the total error (round-off + approximation), <span class="math notranslate nohighlight">\(\epsilon_{\rm tot} \simeq \epsilon_{ro} + \varepsilon\)</span>.  This occurs when the approximation error (which depends on <span class="math notranslate nohighlight">\(N\)</span>) approaches the round-off error.  Through some clever scaling, we find that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N \sim 10^6\)</span> for the Trapezoid rule</p></li>
<li><p><span class="math notranslate nohighlight">\(N \sim 2000\)</span> for Simpson’s rule.</p></li>
</ul>
<p>These results imply the following:</p>
<ul class="simple">
<li><p>Simpson’s rule is an improvement over the trapezoid rule</p></li>
<li><p>Obtaining the best numerical approximation can be achieved with <span class="math notranslate nohighlight">\(N \lesssim 1000\)</span> instead of for <span class="math notranslate nohighlight">\(N \rightarrow \infty.\)</span></p></li>
</ul>
<div align="center">
<iframe width="560" height="315"
src="https://www.youtube.com/embed/i9wmFymvtxw"
frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe>
</div></section>
<section id="integration-by-stone-throwing">
<h2><span class="section-number">4.6. </span>Integration by Stone Throwing<a class="headerlink" href="#integration-by-stone-throwing" title="Permalink to this heading">#</a></h2>
<p>Sometimes you need to find the area of a shape with an irregular boundary.  The standard methods can be quite complex and there are simpler means of obtaining an approximate value.  Another context is when you want to perform multidimensional integrals.  These types of integrals are easily solved through a <em>sampling</em> technique with random numbers.</p>
<figure class="align-default" id="stone-fig">
<a class="reference internal image-reference" href="../_images/stone_throwing.png"><img alt="stone throwing" src="../_images/stone_throwing.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.4 </span><span class="caption-text">Illustration of an irregular shaped pond, where the area could be determined more easily via stone throwing.</span><a class="headerlink" href="#stone-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Suppose you need to find the area of a pond, where most ponds are not regularly shaped due to weathering and erosion.  You can use the following algorithm:</p>
<ol class="arabic simple">
<li><p>Walk off a box that completely encloses the pond and remove any pebbles lying on the ground within the box.</p></li>
<li><p>Measure the lengths of the sides in natural units (feet or meters).  This tells you the area of the enclosing box <span class="math notranslate nohighlight">\(A_{\rm box}\)</span>.</p></li>
<li><p>Grab a bunch of pebbles, count their number, and throw them up in the air in random directions. (Wear a hat!)</p></li>
<li><p>Count the number of splashes in the pond <span class="math notranslate nohighlight">\(N_{\rm pond}\)</span> and the number of pebbles lying on the ground within your box <span class="math notranslate nohighlight">\(N_{\rm box}\)</span>.</p></li>
<li><p>Assuming that you threw the pebbles randomly enough, the number of pebbles falling into the pond should be proportional to the area of the pond <span class="math notranslate nohighlight">\(A_{\rm pond}\)</span>.</p></li>
</ol>
<p>The fraction of pebbles that splash in the pond relative to the total number of pebbles tells you the area within a unit box.  Multiplying by the area of the box <span class="math notranslate nohighlight">\(A_{\rm box}\)</span> in the natural units, then allows you to find the area of the pond:</p>
<div class="amsmath math notranslate nohighlight" id="equation-02caa62d-ffbe-41dc-b302-1c1db3d4eaaa">
<span class="eqno">(4.23)<a class="headerlink" href="#equation-02caa62d-ffbe-41dc-b302-1c1db3d4eaaa" title="Permalink to this equation">#</a></span>\[\begin{align}
A_{\rm pond} = \frac{N_{\rm pond}}{N_{\rm pond}+N_{\rm box}}A_{\rm box}.
\end{align}\]</div>
<p>Let’s use the sampling technique to perform a 2D integration to determine <span class="math notranslate nohighlight">\(\pi\)</span> (in code!) assuming a circular pond.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">stone_throw</span><span class="p">(</span><span class="n">trial_idx</span><span class="p">):</span>
    <span class="c1">#algorithm of stone throwing</span>
    <span class="c1">#performing n number  of trials to see convergence</span>
    <span class="n">A_box</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1">#area of the enclosing square (r = 1 or d = 2)</span>
    <span class="n">N_pebbles</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1">#total number of pebbles</span>

    <span class="n">N_pond</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#initial count of the pebbles</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N_pebbles</span><span class="p">):</span>
        <span class="n">x_samp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">y_samp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">r_samp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_samp</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y_samp</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r_samp</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">N_pond</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">A_pond</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">N_pond</span><span class="o">/</span><span class="n">N_pebbles</span><span class="p">)</span><span class="o">*</span><span class="n">A_box</span>

<span class="n">N_trials</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">A_pond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_trials</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N_trials</span><span class="p">):</span>
    <span class="n">stone_throw</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_pond</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N_trials</span><span class="p">),</span><span class="n">A_pond</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N_trials</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">2.8</span><span class="p">,</span><span class="mf">3.4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Trial Number&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Estimate of $\pi$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3.16 2.88 3.24 3.08 3.16 3.   3.56 3.   3.12 3.28]
</pre></div>
</div>
<img alt="../_images/f8387957102f0e00c0eabefa4a18c1f2d8dce23c55f560314abb3b7093f4ca5e.png" src="../_images/f8387957102f0e00c0eabefa4a18c1f2d8dce23c55f560314abb3b7093f4ca5e.png" />
</div>
</div>
<p>We found a <em>very</em> approximate value for <span class="math notranslate nohighlight">\(\pi\)</span>.  Think about how we can improve the accuracy.</p>
<ul class="simple">
<li><p><strong>Will increasing the number of trials help?</strong></p></li>
<li><p><strong>Would we want to increase the number of pebbles thrown?</strong></p></li>
<li><p><strong>How could we find the number of pebbles needed to get 3 decimal places of precision?</strong></p></li>
</ul>
</section>
<section id="integrating-by-mean-value">
<h2><span class="section-number">4.7. </span>Integrating by Mean Value<a class="headerlink" href="#integrating-by-mean-value" title="Permalink to this heading">#</a></h2>
<p>In the previous section, we integrated using random values.  You might be thinking, how did that even work?  It is the standard Monte Carlo (random value) technique, which is based on the <em>mean value theorem</em> from Calculus.  Here’s the equation in case you’ve forgotten:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e57bbf11-034e-48ce-abda-6cae9f820f80">
<span class="eqno">(4.24)<a class="headerlink" href="#equation-e57bbf11-034e-48ce-abda-6cae9f820f80" title="Permalink to this equation">#</a></span>\[\begin{align}
I = \int_a^b f(x)dx = (b-a)\left&lt;f\right&gt;.
\end{align}\]</div>
<p>The theorem states: the value of the integral of some function <span class="math notranslate nohighlight">\(f(x)\)</span> over the interval from <span class="math notranslate nohighlight">\(a\)</span> to <span class="math notranslate nohighlight">\(b\)</span> equals the length of the interval <span class="math notranslate nohighlight">\((b-a)\)</span> multiplied by the mean value of the function <span class="math notranslate nohighlight">\(\left&lt;f\right&gt;\)</span> over that interval.  More simply, it states that the same area can exist under a complicated curve and within the simplest curve (a horizontal line).</p>
<figure class="align-default" id="mean-value-fig">
<a class="reference internal image-reference" href="../_images/mean_value.png"><img alt="mean_value" src="../_images/mean_value.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.5 </span><span class="caption-text">Illustration of integration by the mean value.</span><a class="headerlink" href="#mean-value-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The integration algorithm uses Monte Carlo techniques to evaluate the mean, which can be written as a summation by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-149f8a42-e8bf-4deb-abfe-07234d2916ce">
<span class="eqno">(4.25)<a class="headerlink" href="#equation-149f8a42-e8bf-4deb-abfe-07234d2916ce" title="Permalink to this equation">#</a></span>\[\begin{align}
\left&lt;f\right&gt; \simeq \frac{1}{N} \sum_{i=1}^N f(x_i).
\end{align}\]</div>
<p>This gives the very simple integration rule:</p>
<div class="amsmath math notranslate nohighlight" id="equation-76b901db-98a2-41f4-ad59-c29475fb9376">
<span class="eqno">(4.26)<a class="headerlink" href="#equation-76b901db-98a2-41f4-ad59-c29475fb9376" title="Permalink to this equation">#</a></span>\[\begin{align} 
\int_a^b f(x)dx \simeq \frac{b-a}{N} \sum_{i=1}^N f(x_i) = (b-a)\left&lt;f\right&gt;.
\end{align}\]</div>
<p>This looks like our standard algorithm <span class="math notranslate nohighlight">\((\sum_i f(x_i)w_i)\)</span>, where the points are chosen randomly and with uniform weights <span class="math notranslate nohighlight">\(w_i = (b-a)/N\)</span>.  This method is not very efficient (i.e., it can take a large N to converge), but it is simple.</p>
<div align="center">
<iframe width="560" height="315"
src="https://www.youtube.com/embed/WAf0rqwAvgg"
frameborder="0" 
allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" 
allowfullscreen></iframe>
</div></section>
<section id="problems">
<h2><span class="section-number">4.8. </span>Problems<a class="headerlink" href="#problems" title="Permalink to this heading">#</a></h2>
<p>Complete the following problems in a Jupyter notebook, where you will save your results as an external file (*.png).</p>
<p>Create a <span class="math notranslate nohighlight">\(\LaTeX\)</span> document with:</p>
<ul class="simple">
<li><p>an abstract summary</p></li>
<li><p>sections for each problem that <strong>state</strong> the problem, <strong>explain</strong> your approach to solving the problem, and <strong>display</strong> the results</p></li>
<li><p>include a reference for each solution (this can be textbooks)</p></li>
</ul>
<div class="admonition-problem-1 admonition">
<p class="admonition-title">Problem 1</p>
<p><strong>Evaluate the following integrals using the a) Trapezoid rule, b) Simpson’s Rule, and c) Gaussian quadrature.</strong>  Include a graph showing each function and shade the area.  Vary the number of intervals needed to give an ‘acceptable’ answer.  In your submitted work, describe your procedure for varying the intervals, create a table summarizing how many intervals were required for each method, and explain why each method(s) require more/less than the others.</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_0^{\pi/2} \cos x dx\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_1^3 1/x^2 dx\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\displaystyle \int_2^4 x^2 + x + 1 dx\)</span></p></li>
</ol>
</div>
<div class="admonition-problem-2 admonition">
<p class="admonition-title">Problem 2</p>
<p><strong>Write a Python program to study projectile motion without air resistance using Simpson’s rule.</strong>  Then apply your program to the following scenario:</p>
<p>You are a pirate cannoneer and your Captain (<em>Hector Barbossa</em>) has ordered you to fire the cannon to begin the siege of Port Royal.  Your Captain wants a short battle, where the British armory is destroyed first and he can begin pillaging right away to find a big hat. Thus, you must make a direct hit on the first shot.  The cannon has a muzzle speed of about 200 m/s and the firing deck is 50 m above sea level.  The Captain has anchored 2000 m off shore relative to the fort walls for the initial battle.  The armory is located at sea level an additional 57 m beyond the fort walls.</p>
<p><strong>(a)</strong>  At what angle (from the horizontal) must you fire the cannon to hit the armory?</p>
<p><strong>(b)</strong>  What is the maximum height (from sea level) will the cannon fly?</p>
<p><strong>(c)</strong>  Compare your results to expectations from theory (i.e., the kinematics you learned in pirate school).  Plot the trajectory (x,y), maximum height, and range determined from your program along with analytic values.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "saturnaxis/CompPhysics",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapter_4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../Chapter_3/Data_Fitting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Data Fitting and Interpolation</p>
      </div>
    </a>
    <a class="right-next"
       href="../Chapter_5/Differentiation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Differentiation and Searching</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quadrature-as-box-counting">4.1. Quadrature as box counting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trapezoidal-rule">4.2. Trapezoidal Rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpson-s-rule">4.3. Simpson’s Rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gaussian-quadrature">4.4. Gaussian Quadrature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-error">4.5. Integration Error</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-by-stone-throwing">4.6. Integration by Stone Throwing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-by-mean-value">4.7. Integrating by Mean Value</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">4.8. Problems</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Billy Quarles
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>